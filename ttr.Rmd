---
title: "TTR"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
pacman::p_load(tidyverse, tsibble, fable, feasts, janitor, lubridate, tseries, TTR)
```

```{r}
assets <- read_csv("BCHAIN-MKPRU.csv") %>%
    left_join(read_csv("LBMA-GOLD.csv")) %>%
    clean_names() %>% 
    mutate(date = mdy(date),
           index = row_number()) %>%
    rename(bitcoin = value,
           gold = usd_pm) %>% 
    as_tsibble()
```


```{r}
bitcoin_ts <- ts(assets$bitcoin)

gold_ts <- read_csv("LBMA-GOLD.csv") %>% 
    select(-Date) %>% 
    drop_na() %>% 
    as.ts()
```

```{r}
ema_btc <- EMA(bitcoin_ts)
plot(ema_btc)

ema_gold <- EMA(gold_ts)
plot(ema_gold)
```

```{r}
chartSeries(bitcoin_ts,
            theme = chartTheme('white'))
addBBands(n=20, sd=2)

chartSeries(gold_ts,
            theme = chartTheme('white'))
addBBands(n=20, sd=2)
```
```{r}
rsi_btc_ema <- RSI(bitcoin_ts, n = 14, maType = "EMA") %>% as_tsibble()

assets <- assets %>% 
    mutate(rsi_btc = rsi_btc_ema$value)

ggplot(rsi_btc_ema, aes(index, value)) + 
    geom_line() + 
    geom_hline(aes(yintercept = 30), color = "red") +
    labs(title = "Relative Strength Index for Bitcoin",
         subtitle = "EMA Over Past 14 Days") +
    xlab("Days") + ylab("RSI") +
    theme_minimal()

```
```{r}
rsi_gold_ema <- RSI(gold_ts, n = 14, maType = "EMA") %>% as_tsibble()

assets <- assets %>% 
    mutate(rsi_gold = rsi_gold_ema$value)

ggplot(rsi_gold_ema, aes(index, value)) + 
    geom_line() + 
    geom_hline(aes(yintercept = 30), color = "red") +
    labs(title = "Relative Strength Index for Gold",
         subtitle = "EMA Over Past 14 Days") +
    xlab("Days") + ylab("RSI") +
    theme_minimal()
```
1. Run RSI multiple times with different Ns and MAs and see which gets you the most amount of money by the end
2. Don't move all of the money at once, use a function dependent on RSI value that moves a portion of the money at a time


